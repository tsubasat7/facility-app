<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é‹å‘½ã®å…­å±æ€§è¨ºæ–­ï¼ˆå†…éƒ¨ãƒ„ãƒ¼ãƒ«ï¼‰</title>

<style>
body{
  font-family:sans-serif;
  background:#fff;
  margin:0;
}
header{
  padding:16px;
  border-bottom:1px solid #eee;
}
.container{
  max-width:900px;
  margin:auto;
  padding:24px;
}
.card{
  border:1px solid #ddd;
  border-radius:16px;
  padding:16px;
  margin-bottom:16px;
}
button{
  padding:10px 16px;
  border-radius:20px;
  border:1px solid #aaa;
  cursor:pointer;
}
.run{
  background:#222;
  color:#fff;
  border:none;
}
small{color:#666;}
input, select{
  padding:8px;
  width:100%;
  box-sizing:border-box;
  margin-top:6px;
}
</style>
</head>

<body>

<header>
<h2>ğŸ”® é‹å‘½ã®å…­å±æ€§è¨ºæ–­ï¼ˆå†…éƒ¨ç”¨ï¼‰</h2>
<small>â€»å‘½æ•°ã¯èª¤å·®é˜²æ­¢ã®ãŸã‚æ‰‹å…¥åŠ›æ–¹å¼</small>
</header>

<div class="container">

<!-- å…¥åŠ›ã‚«ãƒ¼ãƒ‰ -->
<div class="card">
  <label>åå‰</label>
  <input id="name">

  <label style="margin-top:16px;">ç”Ÿå¹´æœˆæ—¥</label>
  <input id="birth" type="date">

  <label style="margin-top:16px;">å‘½æ•°ï¼ˆ1ã€œ60ï¼‰â€»æ‰‹å…¥åŠ›</label>
  <input id="meisuu" type="number" min="1" max="60">

  <button class="run" style="margin-top:16px;" onclick="analyze()">è¨ºæ–­ã™ã‚‹</button>
</div>

<!-- çµæœè¡¨ç¤º -->
<div id="result"></div>

</div>

<script>
// ----------------------
// JSON ã‚’å®‰å…¨ã«èª­ã¿è¾¼ã‚€é–¢æ•°
// ----------------------
async function safeFetch(path){
  try{
    const r = await fetch(path);
    if(!r.ok) throw new Error();
    return await r.json();
  }catch(e){
    // JSON ãŒç„¡ãã¦ã‚‚å‹•ãå®‰å…¨å¯¾ç­–
    return {};
  }
}

// ----------------------
// ãƒ¡ã‚¤ãƒ³è¨ºæ–­å‡¦ç†
// ----------------------
async function analyze(){
  const name  = document.getElementById("name").value.trim() || "æœªå…¥åŠ›";
  const birth = document.getElementById("birth").value.trim() || "æœªå…¥åŠ›";
  const meisuu = Number(document.getElementById("meisuu").value);

  if(!meisuu || meisuu < 1 || meisuu > 60){
    alert("å‘½æ•°ã‚’ 1ã€œ60 ã§å…¥åŠ›ã—ã¦ãã ã•ã„");
    return;
  }

  // JSON ã‚’èª­ã¿è¾¼ã¿ï¼ˆå­˜åœ¨ã—ãªã„å ´åˆã¯ç©ºã§ç¶™ç¶šï¼‰
  const traits = await safeFetch("data/flattype_traits.json");
  const story  = await safeFetch("data/story.json");

  const key = String(meisuu);

  const t = traits[key] || {};
  const s = story[key]  || {};

  document.getElementById("result").innerHTML = `
    <div class="card">
      <h3>${name} ã•ã‚“</h3>
      <p><b>ç”Ÿå¹´æœˆæ—¥ï¼š</b>${birth}</p>
      <p><b>å‘½æ•°ï¼š</b>${meisuu}</p>

      <h4>â–  æ€§æ ¼ãƒ»å‚¾å‘</h4>
      <p>${t.core || "ï¼ˆãƒ‡ãƒ¼ã‚¿æœªè¨­å®šï¼‰"}</p>

      <h4>â–  éå»ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</h4>
      <p>${s.past || "ï¼ˆãƒ‡ãƒ¼ã‚¿æœªè¨­å®šï¼‰"}</p>
    </div>
  `;
}
</script>

</body>
</html>
